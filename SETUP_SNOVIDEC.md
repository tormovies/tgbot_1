# Настройка бота в папке snovidec.ru/tgbot98/

**Путь на сервере:** `~/bot.snovidec.ru/public_html/tgbot98`

Бот будет доступен по адресу: **https://snovidec.ru/tgbot98/** (или **http://bot.snovidec.ru/tgbot98/**)  
**Админка (входить только по этому адресу):** **http://bot.snovidec.ru/tgbot98/admin/**

---

## Шаг 1. Положить файлы в папку tgbot98

На сервере нужна папка, которая в браузере открывается как **snovidec.ru/tgbot98/**.

- **Если есть SSH:** зайди на сервер, перейди в корень сайта и выполни:
  ```bash
  cd ~/bot.snovidec.ru/public_html
  git clone https://github.com/tormovies/tgbot_1.git tgbot98
  cd tgbot98
  ```
- **Если только панель хостинга (FTP/файловый менеджер):** скачай архив с [GitHub](https://github.com/tormovies/tgbot_1) (Code → Download ZIP), распакуй и залей содержимое в папку **tgbot98** внутри корня сайта snovidec.ru.

В итоге по адресу **https://snovidec.ru/tgbot98/** должны лежать файлы: `bot.php`, `config.sample.php`, папки `admin/`, `lib/`, `data/`.

---

## Шаг 2. Создать config.php

В папке **tgbot98** должен быть файл **config.php** (секреты в нём не попадают в git).

- **Через SSH:**
  ```bash
  cd ~/bot.snovidec.ru/public_html/tgbot98
  cp config.sample.php config.php
  nano config.php
  ```
- **Через панель/FTP:** скопируй `config.sample.php` в новый файл `config.php`, открой его для редактирования.

Заполни в **config.php**:

- `BOT_TOKEN` — токен от @BotFather  
- `DEEPSEEK_API_KEY` — ключ с platform.deepseek.com  
- `ADMIN_LOGIN` — логин для входа в админку (например `admin`)  
- `ADMIN_PASSWORD` — пароль для админки  

Сохрани файл.

---

## Шаг 3. Права на папку data

Нужно, чтобы скрипт мог создавать и писать файлы в папке **tgbot98/data/** (база SQLite и логи).

- **Через SSH:**
  ```bash
  chmod 755 ~/bot.snovidec.ru/public_html/tgbot98/data
  ```
  Если веб-сервер работает от пользователя `www-data` (или `apache`):
  ```bash
  chown -R www-data:www-data ~/bot.snovidec.ru/public_html/tgbot98/data
  ```
- **Через панель хостинга:** в правах на папку **data** выставь, что папка доступна на запись (обычно 755 или 775, в зависимости от хостинга).

---

## Шаг 4. Запустить бота (он должен работать постоянно)

Бот — это не веб-страница, а фоновый процесс `php bot.php`. Его нужно запустить на сервере и держать включённым.

- **Если есть SSH:**
  ```bash
  cd ~/bot.snovidec.ru/public_html/tgbot98
  nohup php bot.php > data/bot.log 2>&1 &
  ```
  Проверить, что процесс есть: `ps aux | grep bot.php`  
  Логи: `tail -f data/bot.log`

  Чтобы бот перезапускался после перезагрузки сервера, настрой systemd (пример в README.md).

- **Если SSH нет (только панель хостинга):**  
  У многих обычных хостингов нельзя держать процесс запущенным 24/7. Нужен либо VPS/сервер с SSH, либо «длинные задачи» в панели (если есть). Тогда в инструкции к хостингу смотри, как запускать фоновый PHP-скрипт.

---

## Шаг 5. Проверить бота в Telegram

1. Напиши боту в личку команду **/start**.
2. Отправь **/son**, затем следующим сообщением — текст сна.
3. Расшифровка должна прийти в личку. Если пришла — бот настроен верно.

---

## Шаг 6. Зайти в админку

1. В браузере открой именно (с **/admin/** в конце): **http://bot.snovidec.ru/tgbot98/admin/**
2. Введи логин и пароль из **config.php**.
3. На странице логов должны отображаться запросы (тексты снов) и ответы (расшифровки).

---

## Шаг 7. Добавить бота в группу

1. В группе Telegram: «Добавить участников» → найти бота по @username.
2. Участники пишут **/son**, затем текст сна; расшифровка приходит им в личку.
3. Каждый пользователь должен хотя бы раз написать боту в личку (например, /start), иначе бот не сможет отправить ему ответ в личные сообщения.

---

## Кратко

| Шаг | Действие |
|-----|----------|
| 1 | Положить файлы в папку, которая открывается как snovidec.ru/tgbot98/ |
| 2 | Создать config.php из config.sample.php и заполнить токены и пароль админки |
| 3 | Выставить права на папку data (запись) |
| 4 | Запустить на сервере: `nohup php bot.php > data/bot.log 2>&1 &` (через SSH) |
| 5 | Проверить в Telegram: /start, /son + текст сна |
| 6 | Зайти в админку: https://snovidec.ru/tgbot98/admin/ |
| 7 | Добавить бота в группу и пользоваться |

Если на шаге 4 нет доступа по SSH — нужен хостинг/VPS, где можно запускать долгий процесс (например, VPS с SSH).
